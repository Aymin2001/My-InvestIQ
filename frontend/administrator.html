<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Administrator</title>
    <link rel="stylesheet" href="./css/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Favicon -->

    <link href="img/favicon.ico" rel="icon" />
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jost:wght@500;600;700&family=Open+Sans:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <!-- Link to Font Awesome CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <!-- Icon Font Stylesheet -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet" />
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />
  </head>
  <body>
    <div class="menu-icon" onclick="toggleSidebar()">&#9776;</div>

    <div class="Dashboard-container">
      <div class="sidebar" id="sidebar">
        <span class="close-icon" onclick="toggleSidebar()">&times;</span>
        <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">
          <a
            href="index.html"
            class="navbar-brand ms-4 ms-lg-0 d-flex justify-content-start align-items-end position-relative"
          >
            <img src="./img/logo.png" alt="logo" width="60" height="50" />
            <h1 id="glitterText" class="display-6 m-0 gradient-text">
              Invest<span class="text-purple">I</span
              ><span class="text-cyan">Q</span>
            </h1>
          </a>
        </h5>
        <div class="column">
          <div class="rows mt-5" data-tab="dashboard">
            <i class="fas fa-home"></i>
            <p>Dashboard</p>
          </div>
          <div class="rows" data-tab="feedback">
            <i class="fas fa-comments"></i>
            <p>Feedback</p>
          </div>
          <div class="rows" data-tab="settings">
            <i class="fas fa-cog"></i>
            <p>Settings</p>
          </div>
          <div class="rows" data-tab="profile">
            <i class="fas fa-user"></i>
            <p>Profile</p>
          </div>
          <div class="rows" data-tab="register">
            <i class="fas fa-user"></i>
            <p>Register Admin</p>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="tab-content active" id="dashboard-content">
          <!-- for service -->
          <table id="serviceTable">
            <caption>
              Services Detail
            </caption>
            <thead>
              <tr>
                <th scope="col">Name</th>
                <th scope="col">Email</th>
                <th scope="col">Mobile No</th>
                <th scope="col">Subject</th>
                <th scope="col">Message</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="tab-content" id="feedback-content">
          <table id="contactTable">
            <caption>
              Contact Us Detail
            </caption>
            <thead>
              <tr>
                <th scope="col">Name</th>
                <th scope="col">Email</th>
                <th scope="col">Subject</th>
                <th scope="col">Message</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="tab-content" id="settings-content">
          <div
            class="modal-content"
            id="modal-content"
            style="width: 100%; max-width: 600px; margin: 5% auto"
          >
            <h3
              id="glitterText"
              class="gradient-text display-5 mb-3 text-center"
            >
              Rese<span class="text-purple">t</span
              ><span class="text-cyan">Password</span>
            </h3>
            <form id="login-form">
              <div class="input-group">
                <input
                  type="email"
                  name="email"
                  placeholder="Email"
                  id="admin-email"
                  required
                />
              </div>
              <div class="input-group">
                <input
                  type="password"
                  name="password"
                  placeholder="Password"
                  id="admin-pswrd"
                  required
                />
              </div>
              <div class="input-group">
                <input
                  type="password"
                  name="reset-password"
                  placeholder="Password"
                  id="admin-resetpswrd"
                  required
                />
              </div>
              <div class="input-group">
                <button type="submit" class="submit-button">Submit</button>
              </div>
            </form>
          </div>
        </div>
        <div class="tab-content" id="profile-content">
          <div class="profile-container">
            <div class="profile-content">
              <img src="./img/profileimg.jpg" width="200px" height="200px" />
              <div class="profile-info">
                <span>ADMIN</span>
                <p>Joined on 12 Jan</p>
                <div class="info-icons">
                  <div class="info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>City</span>
                  </div>
                  <div class="info-item">
                    <i class="fas fa-phone"></i>
                    <span>Phone No</span>
                  </div>
                  <div class="info-item">
                    <i class="fas fa-envelope"></i>
                    <span>Email</span>
                  </div>
                  <div class="info-item">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Date of Birth</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="dropdown" onclick="toggleDropdown()">
              <i class="fas fa-ellipsis-h dot-icon dropdown-dot"></i>
              <div class="dropdown-content" id="dropdownContent">
                <a href="#"><i class="fas fa-cog"></i> Settings</a>
                <a href="#"><i class="fas fa-user-plus"></i> Register</a>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-content" id="register-content">
          <div
            class="modal-content mt-1"
            id="modal-content"
            style="width: 100%; max-width: 650px"
          >
            <h3
              id="glitterText"
              class="gradient-text display-5 mb-3 text-center"
            >
              Regis<span class="text-purple">t</span
              ><span class="text-cyan">er Admin</span>
            </h3>
            <form id="login-form">
              <div class="input-group">
                <input
                  type="email"
                  name="email"
                  placeholder="Email"
                  id="admin-email"
                  required
                />
              </div>
              <div class="input-group">
                <input
                  type="password"
                  name="password"
                  placeholder="Password"
                  id="admin-pswrd"
                  required
                />
              </div>
              <div class="input-group">
                <input
                  type="text"
                  name="name"
                  placeholder="Name"
                  id="admin-name"
                  required
                />
              </div>
              <div class="input-group">
                <input
                  type="date"
                  name="dob"
                  placeholder="Date of Birth"
                  id="admin-dob"
                  required
                />
              </div>
              <div class="input-group">
                <input
                  type="text"
                  name="city"
                  placeholder="City"
                  id="admin-city"
                  required
                />
              </div>
              <div class="input-group">
                <input
                  type="tel"
                  name="phone"
                  placeholder="Phone Number"
                  id="admin-phone"
                  required
                />
              </div>

              <div class="input-group">
                <button type="submit" class="submit-button">Submit</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- toggle sidebar -->
    <script>
      function toggleSidebar() {
        var sidebar = document.getElementById("sidebar");
        sidebar.classList.toggle("show");
      }
    </script>

    <!-- for fetching and deleting service detail -->

    <script>
      fetch("https://my-invest-iq-backend.vercel.app/api/service/getServices")
        .then((response) => response.json())
        .then((data) => {
          const tableBody = document.querySelector("#serviceTable tbody");

          data.forEach((service) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                      <td scope="row" data-label="NAME">${service.name}</td>
                      <td scope="row" data-label="EMAIL">${service.email}</td>
                      <td scope="row" data-label="PHONE-NO">${service.mobileNo}</td>
                      <td scope="row" data-label="SUBJECT">${service.subject}</td>
                      <td scope="row" data-label="MESSAGE">${service.message}</td>
                      <td>
                          <button class="btn-delete" data-service-id="${service._id}">Delete</button>
                      </td>
                  `;
            tableBody.appendChild(row);
          });

          const deleteButtons = document.querySelectorAll(".btn-delete");
          deleteButtons.forEach((button) => {
            button.addEventListener("click", () => {
              const serviceId = button.getAttribute("data-service-id");
              if (serviceId) {
                deleteService(serviceId);
              } else {
                console.error("Service ID is missing or invalid");
              }
            });
          });
        })
        .catch((error) =>
          console.error("Error fetching service details:", error)
        );

      function deleteService(serviceId) {
        fetch(
          `https://my-invest-iq-backend.vercel.app/api/service/Service/${serviceId}`,
          {
            method: "DELETE",
          }
        )
          .then((response) => {
            if (response.ok) {
              const rowToDelete = document.querySelector(
                `[data-service-id="${serviceId}"]`
              ).parentNode.parentNode;
              rowToDelete.parentNode.removeChild(rowToDelete);
            } else {
              throw new Error("Failed to delete service");
            }
          })
          .catch((error) => console.error("Error deleting service:", error));
      }
    </script>

    <!-- for fetching and deleting contact detail -->
    <script>
      fetch("https://my-invest-iq-backend.vercel.app/api/contact/getContacts")
        .then((response) => response.json())
        .then((data) => {
          const tableBody = document.querySelector("#contactTable tbody");

          data.forEach((contact) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                        <td scope="row" data-label="NAME">${contact.name}</td>
                        <td scope="row" data-label="EMAIL">${contact.email}</td>
                        <td scope="row" data-label="SUBJECT">${contact.subject}</td>
                        <td scope="row" data-label="MESSAGE">${contact.message}</td>
                        <td>
                            <button class="btn-delete" data-contact-id="${contact._id}">Delete</button>
                        </td>
                    `;
            tableBody.appendChild(row);
          });

          const deleteButtons = document.querySelectorAll(".btn-delete");
          deleteButtons.forEach((button) => {
            button.addEventListener("click", () => {
              const contactId = button.getAttribute("data-contact-id");
              deleteContact(contactId);
            });
          });
        })
        .catch((error) =>
          console.error("Error fetching contact details:", error)
        );

      function deleteContact(contactId) {
        fetch(
          ` https://my-invest-iq-backend.vercel.app/api/contact/Contact/${contactId}`,
          {
            method: "DELETE",
          }
        )
          .then((response) => {
            if (response.ok) {
              const rowToDelete = document.querySelector(
                `[data-contact-id="${contactId}"]`
              ).parentNode.parentNode;
              rowToDelete.parentNode.removeChild(rowToDelete);
            } else {
              throw new Error("Failed to delete contact");
            }
          })
          .catch((error) => console.error("Error deleting contact:", error));
      }
    </script>
    <!-- active tab bar colour -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const tabLinks = document.querySelectorAll(".rows");
        const tabContents = document.querySelectorAll(".tab-content");

        tabLinks.forEach(function (link) {
          link.addEventListener("click", function () {
            const tabId = this.dataset.tab;

            tabContents.forEach(function (content) {
              content.classList.remove("active");
            });

            document.getElementById(tabId).classList.add("active");
          });
        });
      });
    </script>
    <!-- shows content on right side based on selected tab -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const tabs = document.querySelectorAll(".rows");
        const tabContents = document.querySelectorAll(".tab-content");

        tabs.forEach((tab) => {
          tab.addEventListener("click", function () {
            const tabData = this.getAttribute("data-tab");
            const content = document.getElementById(`${tabData}-content`);

            tabContents.forEach((item) => {
              item.classList.remove("active");
            });

            content.classList.add("active");
          });
        });
      });
    </script>
    <!-- drop down show -->
    <script>
      function toggleDropdown() {
        var dropdownContent = document.getElementById("dropdownContent");
        dropdownContent.classList.toggle("show-dropdown");
      }
    </script>
  </body>
</html>
